<html>

<head>
	<title>Шарипов Р.А. ЭАС-409 Лабораторная работа Вариант №</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">
	<script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
	<style>
	#center {
		text-align: center;
	}
	
	h1 {
		font-family: 'Times New Roman', Times, sans-serif;
		font-size: 150%;
	}
	
	p {
		font-family: 'Times New Roman', Arial, Helvetica, sans-serif;
		font-size: 15pt;
	}
	</style>
	<script>
		var timer1=[]
		var i = 0
		var names = [ "Норина Людмила", "Ярощук Александра", "Веденеева Варвара", "Баженова Полина", "Густокашина Альбина", "Талызина Кристина", "Касатая Ольга", "Николина Лиана", "Панова Вероника", "Горева Милена", "Порошина Евдокия", "Алиева Юнона", "Гнусарева Ефросинья", "Швечикова Диана", "Салко Рената", "Липова Регина", "Чадова Ника", "Яненко Василиса", "Полыгалова Нона", "Рясная Эмма", "Циолковская Элеонора", "Семерикова Маргарита", "Пономарева Дарья", "Вавилова Ярослава", "Якутина Наталия", "Яковленко Тамара", "Кузик Софья", "Савватимова Ульяна", "Бальсунова Рада", "Андрюшина Лилия", "Абоимова Каролина", "Минаева Анисья", "Клепахова Зоя", "Машукова Лада", "Викариева Римма", "Антонович Мария", "Ухтомская Нина", "Яглинцева Доминика", "Ялбачева Изольда", "Ельцина Анастасия", "Ипатьева Берта", "Тарасова Христина", "Полищука Всеслава", "Скуратова Майя", "Игнатенкова Фаина", "Бурова Антонина", "Масмех Ангелина", "Булатова Розалия", "Захарова Ксения", "Кутузова Вера", "Токарева Инна", "Бесфамильнова Эльвира", "Модзалевская Инесса", "Чернакова Эвелина", "Суворова Галина", "Оболенская Марфа", "Перова Ева", "Кузина Таисия", "Эйбоженко Роза", "Якушкина Лидия", "Корявова Валентина", "Кетова Марта", "Корепанова Ефросиния", "Цыцына Надежда", "Барсукова Любовь", "Левченко Анфиса", "Грибакина Клара", "Курзыбова Агафья", "Килиц Эмилия", "Исакова Владислава", "Бабанова Ирина", "Лаер Алла", "Толоконская Дина", "Маркина Жанна", "Магазинер Владлена", "Головаха Стела", "Гавриленкова Любава", "Жернакова Светлана", "Булка Ариадна", "Мячикова Елизавета", "Ярошенко Виктория", "Герцая Юлия", "Корнейчука Екатерина", "Ивашечкина Изабелла", "Ягубова Анна", "Разбойникова Аза", "Михальченко Яна", "Кузьмова Марианна", "Паулкина Лариса", "Тимашева Оксана", "Николаева Наталья", "Сабанцева Раиса", "Яцковская Алина", "Тюшнякова Агния", "Батрутдинова Кира", "Полешко Зинаида", "Лаврентьева Злата", "Филимонова Елена", "Немцова Ираида", "Алленова Янина", "Панков Ульян", "Статник Парфен", "Верещагин Пимен", "Машарин Тимур", "Горелов Игорь", "Астанков Кондратий", "Соболев Фадей", "Ермолин Валерьян", "Шипеев Виссарион", "Типалов Никанор", "Ядрищенский Макар", "Завражин Фома", "Ярков Феликс", "Набутов Петр", "Карандашов Денис", "Флёров Сигизмунд", "Новожилов Евсей", "Русаков Евстигней", "Котов Ефим", "Ярошинский Владилен", "Вельдин Тарас", "Пузаков Мстислав", "Гайдук Викентий", "Черенчиков Константин", "Зиновьев Ян", "Аристархов Пахом", "Авилов Данила", "Грузов Владислав", "Ростовцев Лукьян", "Пушкин Самуил", "Низов Юрий", "Рыжков Потап", "Дюженков Ярослав", "Привалов Венедикт", "Бандуркин Всеслав", "Кауфман Роман", "Зворыгин Арсений", "Щекочихин Евгений", "Крючков Артемий", "Кравец Алексей", "Шкиряк Вацлав", "Роговский Мечислав", "Воронцов Виталий", "Койтасбаев Глеб", "Локтионов Вячеслав", "Гик Артём", "Чан Иннокентий", "Маклаков Онисим", "Боголепов Эрнст", "Кудяшов Даниил", "Апалков Бронислав", "Муленко Святослав", "Жабин Александр", "Фролов Богдан", "Филиппов Валентин", "Пода Мартын", "Витаев Феофан", "Цур-Милен Федор", "Бобров Борислав", "Сальников Ерофей", "Мурогов Ростислав", "Малинов Герман", "Кравцев Радион", "Шпикалов Станислав", "Гулин Феоктист", "Щеголев Зиновий", "Булдаков Адриан", "Бобриков Павел", "Викаш Карп", "Горбунков Платон", "Трындин Фока", "Гришко Илья", "Калдярв Андриян", "Митрохов Владимир", "Кадников Гаврила", "Сюсин Руслан", "Сапожников Сидор", "Мичуев Иосиф", "Халтурин Марк", "Сиянцев Клавдий", "Климцов Осип", "Гибазов Захар", "Яшуков Дементий", "Барановский Емельян", "Горюшин Изяслав", "Батурин Эмиль", "Карпюк Агап", "Ширманов Олег", "Кочнев Тит", "Хесман Лука", "Бобр Порфирий", "Мельников Остап", "Жаглин Карл", "Шеин Лев", "Катькин Егор", "Золотарёв Терентий", "Снытко Михаил", "Строганов Трофим", "Гриневец Рубен", "Пестов Прокофий","Вася Пупкин" ];
	$(function() {
			var nomer = 1
		$("#start").click(function(){
					$("#start").button({ disabled: true });
					$("#stop").button({ disabled: false });
			var col1 = 500000
			var col2 = 500000
			var col3 = 500000
					timer = setInterval(()=>{
						let min=5000
						let max=10000
						let tranz
						let t1
						t1=Math.floor(Math.random() * (max - min)) + min
						timer1[i] = setTimeout(()=>{
							let min4=1
							let max4=3
							let r1
							r1=Math.floor(Math.random() * (max4 - min4)) + min4
							console.log(r1)
							if (r1==1){
								tranz="Пополнение"
							}
							else{tranz="Списание"}

							let min1=0
							let max1=200
							let r
							r=Math.floor(Math.random() * (max1 - min1)) + min1
							let name=names[r]

							let min3=1
							let max3=4
							let r3
							r3=Math.floor(Math.random() * (max3 - min3)) + min3

							let min2=1
							let max2=302
							let r2
							r2=Math.floor(Math.random() * (max2 - min2)) + min2
							r2=r2*100

							if (r3==1 && r1==1){
								col1=col1+r2
							}
							else if (r3==1 && r1==2){
								col1=col1-r2
							}
							else if (r3==2 && r1==1){
								col2=col2+r2
							}
							else if (r3==2 && r1==2){
								col2=col2-r2
							}
							else if (r3==3 && r1==1){
								col3=col3+r2
							}
							else if (r3==3 && r1==2){
								col3=col3-r2
							}

							let date=new Date()
							let hh=date.getHours()<10?"0"+date.getHours():date.getHours()
							let mm=date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes()
							let ss=date.getSeconds()<10?"0"+date.getSeconds():date.getSeconds()
							table1.row.add( [
								nomer,
                    			tranz,
                    			name,
                    			r2+" руб.",
                    			date.getDate()+"."+(date.getMonth()+1)+"."+date.getFullYear()+" "+hh+":"+mm+":"+ss,
                    			r3
                			] ).draw(true)

							nomer=nomer+1
                			bank1.data.push(col1)
                			bank2.data.push(col2)
                			bank3.data.push(col3)

							SD.labels.push(hh+":"+mm+":"+ss)
    						lineChart.data=SD
    						lineChart.update();
						}, t1)
						i++
					},5000)
				})

		$("#stop").click(function(){
			$("#start").button({ disabled: false });
			$("#stop").button({ disabled: true });
                    clearInterval(timer)
                    for(i1=0;i1<=i;i1++){
                        clearTimeout(timer1[i1])
                    }
                    t=0
                    i=0
                    table1.clear();
                    table1.draw();
                    for(i2=0;i2<nomer;i2++){
                        lineChart.data.labels.pop();
                        lineChart.data.datasets.forEach((dataset) => {
                            dataset.data.pop();
                        });
                        lineChart.update();
                    }
                })
		$("button").button();
		$("#security").button({ disabled: true });
		$("#technik").button({ disabled: true });
		$("#open1").button({ disabled: true });
		$("#open2").button({ disabled: true });
		$("#off1").button({ disabled: true });
		$("#on1").button({ disabled: true });
		$("#off2").button({ disabled: true });
		$("#on2").button({ disabled: true });
		$("#off3").button({ disabled: true });
		$("#on3").button({ disabled: true });
		$("#start").button({ disabled: false });
		$("#stop").button({ disabled: true });
		$('#dialog').dialog({
			width: 400,
			autoOpen: false
		});
		$('#dialog2').dialog({
			width: 400,
			autoOpen: false
		});
		$('#open1').click(function(event) {
			$('#dialog').dialog('open');
		});
		$("#slider").slider({
			value: 1000,
			min: 100,
			max: 25000,
			step: 100,
			slide: function(event, ui) {
				$("#amount").val(ui.value + " руб.");
			}
		});
		$('#open2').click(function(event) {
			$('#dialog2').dialog('open');
		});
		$("#slider2").slider({
			value: 1000,
			min: 100,
			max: 25000,
			step: 100,
			slide: function(event, ui) {
				$("#amount2").val(ui.value + " руб.");
			}
		});
		$("#amount").val($("#slider").slider("value") + " руб.");
		$("#amount2").val($("#slider2").slider("value") + " руб.");
		$('#filtr1').click(function(event) {
			$('#dialog').dialog('close');
		});
		$('#filtr2').click(function(event) {
			$('#dialog2').dialog('close');
		});
		$('#tabs').tabs();
		$("#checkbox-1").checkboxradio();
		var table1=$('#example').DataTable({
			"language": {
				"zeroRecords": "Записей нет",
				"search": "Поиск:"
			},
			"scrollCollapse": true,
			"paging": false,
			"info": false,
			"autoWidth": true
		});
		var speedCanvas = document.getElementById("speedChart");
		Chart.defaults.global.defaultFontFamily = "Lato";
		Chart.defaults.global.defaultFontSize = 18;
		var bank1 = {
			"label": "Банкомат №1",
			"data": 0,
			"fill": true,
			"backgroundColor": "rgba(44, 72, 212, 0.2)",
			"borderColor": "rgba(44, 72, 212, 1)"
		};
		var bank2 = {
			"label": "Банкомат №2",
			"data": 0,
			"fill": true,
			"backgroundColor": "rgba(63, 115, 79, 0.2)",
			"borderColor": "rgba(63, 115, 79, 1)"
		};
		var bank3 = {
			"label": "Банкомат №3",
			"data": 0,
			"fill": true,
			"backgroundColor": "rgba(255, 108, 0, 0.2)",
			"borderColor": "rgba(255, 108, 0, 1)"
		};
		var SD = {
			"labels": 0,
			"datasets": [bank1, bank2, bank3]
		};
		var chartOptions = {
			legend: {
				display: true,
				position: 'top',
				labels: {
					boxWidth: 80,
					fontColor: 'black'
				}
			}
		};
		var lineChart = new Chart(speedCanvas, {
			type: 'line',
			data: SD,
			options: chartOptions
		});

	});
	</script>
</head>

<body>
	<div id="center">
		<h1>Добро пожаловать в панель управления СРВ "Банкомат"</h1>
		<p>Для начала работы перейдите во вкладку Управление</p>
	</div>
	<div id="tabs">
		<ul>
			<li><a href="#tabs-0">Управление</a></li>
			<li><a href="#tabs-4">Сервер</a></li>
			<li><a href="#tabs-1">Список транзакций</a></li>
			<li><a href="#tabs-2">График</a></li>
			<li><a href="#tabs-3">Устранение аварийных ситуаций</a></li>
		</ul>
		<div id="tabs-0">
			<fieldset>
				<label for="checkbox-1">Автоматическое исправление аварийных ситуаций</label>
				<input type="checkbox" name="checkbox-1" id="checkbox-1">
				<br>
				<br>
				<button id="start">Начать симуляцию</button>
				<button id="stop">Закончить симуляцию</button>
			</fieldset>
			<br>
			<fieldset>
			<button id="open1">Настроить минимальную сумму списания средств</button>
			<br>
			<br>
			<button id="open2">Настроить максимальную сумму пополнения</button>
			</fieldset>
			<div id="dialog" title="Минимальная сумма списания средств">
				<div class="slider1" width="400">
					<p>
						<label for="amount">Выберите минимальную сумму, которую смогут списать клиенты</label>
						<input type="text" id="amount" readonly style="border:0; color:#f6931f; font-weight:bold;"> </p>
					<div id="slider"></div>
				</div>
				<br>
				<button id="filtr1">Применить</button>
			</div>
			<div id="dialog2" title="Минимальная сумма пополнения">
				<div class="slider2" width="400">
					<p>
						<label for="amount2">Выберите максимальную сумму пополнения</label>
						<input type="text" id="amount2" readonly style="border:0; color:#f6931f; font-weight:bold;"> </p>
					<div id="slider2"></div>
				</div>
				<br>
				<button id="filtr2">Применить</button>
			</div>
		</div>
		<div id="tabs-4">
			<fieldset>
			<legend>Управление банкоматом №1</legend>
			<button id="off1">Отключить банкомат</button>
			<button id="on1">Включить банкомат</button>
			<br><br>Состояние банкомата -
			</fieldset>
			<br>
			<fieldset>
			<legend>Управление банкоматом №2</legend>
			<button id="off2">Отключить банкомат</button>
			<button id="on2">Включить банкомат</button>
			<br><br>Состояние банкомата -
			</fieldset>
			<br>
			<fieldset>
			<legend>Управление банкоматом №3</legend>
			<button id="off3">Отключить банкомат</button>
			<button id="on3">Включить банкомат</button>
			<br><br>Состояние банкомата -
			</fieldset>
		</div>	
		<div id="tabs-1">
			<table id="example" class="display" cellspacing="0" width="100%">
				<thead>
					<tr>
						<th>Номер транзакции</th>
						<th>Тип транзакции</th>
						<th>Имя клиента</th>
						<th>Сумма</th>
						<th>Время транзакции</th>
						<th>№ Банкомата</th>
					</tr>
				</thead>
			</table>
		</div>
		<div id="tabs-2">
			<canvas id="speedChart" width="600" height="400"></canvas>
		</div>
		<div id="tabs-3">
			<button id="security">Вызвать службу охраны</button>
			<br>
			<br>
			<button id="technik">Вызвать техника</button>
		</div>
	</div>
</body>
